<!DOCTYPE html>
<html>

<head>
    <base target="_top">
    <?!= include('Stylesheet'); ?>
</head>

<body>
    <div id="sidebar">
        <img src="https://lh7-us.googleusercontent.com/IprvEwobZZGe0uxjsdz_pFBQBstZwVwi3zYcrAAlEwnyn64AQWdKKexanzY0yHyvUxxFSCNEppP0otAdZ8De9Hc2uxjNWKL8kmsTwwv2ne_62MAkFcLs69siUF3gftV2qCneB7QXjDnhDdnz" alt="Logo">

        <form onsubmit="event.preventDefault(); submitTestEmail(document.getElementById('template-dropdown').value)">

            <label for="input">Email ID:</label>
            <input type="email" id="input" name="input" placeholder="user@example.com">

            <div id="message"> Just a heads up! An actual email will be sent to the email address you provided. </div>

            <label for="template-dropdown" style="margin-top: 20px;">Select a Template</label>

            <select id="template-dropdown" name="template-dropdown">
                <? for (var i = 0; i < myOptions.length; i++) { ?>
                <option value="<?= myOptions[i] ?>"><?= myOptions[i] ?></option>
                <? } ?>
            </select>


            <div class="btn-container">
                <input type="submit" value="Test Mail">
            </div>

            <div style="position: fixed; bottom: 10px; left: 10px;">
                <a href="https://gentlereminder.in/" target="_blank" style="color: #999999; font-size: 11px; font-style: italic;">View feature in Documentation</a>
            </div>
        </form>
    </div>
    <script>
        function submitTestEmail(rowCount) {
            var dropdown = document.getElementById('template-dropdown');
            var selectedOption = dropdown.options[dropdown.selectedIndex];
            var templateName = selectedOption.text;
            var selectedIndex = dropdown.selectedIndex;
            var emailInput = document.getElementById('input').value;

            google.script.run.submitTestEmailName({
                testEmail: emailInput,
                rowCount: selectedIndex,
                templateName: templateName
            });
        }
    </script>
</body>

</html>
